!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("phylocanvas"));else if("function"==typeof define&&define.amd)define(["phylocanvas"],t);else{var n=t("object"==typeof exports?require("phylocanvas"):e.phylocanvas);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(this,function(e){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){e(this,"createTree",function(e,t){var n=e.apply(void 0,r(t)),o=s(t,2),i=o[1],a=void 0===i?{}:i;return n.history=new b(n,a.history||{}),n}),this.History=b}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(l){o=!0,i=l}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t["default"]=i;var l=n(1),c=l.utils.dom,u=c.addClass,p=c.removeClass,d=l.utils.events,h=d.fireEvent,f=d.addEvent,y=d.killEvent,v="phylocanvas-history-snapshot",g=v+"--selected",b=function(){function e(t,r){var i=this,s=r.unstyled;o(this,e),this.tree=t,this.snapshots=[],s||(n(2),this.tree.containerElement.style.overflow="hidden"),this.isOpen=!1,this.container=this.createElements(t.containerElement),this.tree.addListener("subtree",function(e){var t=e.node;return i.addSnapshot(t)}),this.tree.addListener("loaded",function(){return i.addSnapshot(i.tree.root.id)}),this.tree.addListener("typechanged",function(){return i.addSnapshot(i.tree.root.id)})}return a(e,[{key:"toggle",value:function(){this.isOpen=!this.isOpen,(this.isOpen?u:p)(this.container,"phylocanvas-history--open"),h(this.tree.containerElement,"historytoggle",{isOpen:this.isOpen})}},{key:"createElements",value:function(e){var t=document.createElement("div");t.className="phylocanvas-history",f(t,"click",y),f(t,"contextmenu",y);var n=document.createElement("div");n.innerHTML="History",n.className="phylocanvas-history-title",t.appendChild(n);var r=document.createElement("button");r.className="phylocanvas-history-button",r.title="History",f(r,"click",this.toggle.bind(this)),t.appendChild(r),this.button=r;var o=document.createElement("ul");return o.className="phylocanvas-history-snapshots",t.appendChild(o),this.snapshotList=o,e.appendChild(t),t}},{key:"addSnapshot",value:function(e){if(e){var t="phylocanvas-history-",n=this.tree.treeType,r=!1;if(this.snapshots.forEach(function(o){p(o,g),o.id===t+e&&o.getAttribute("data-tree-type")===n&&(r=!0,u(o,g))}),!r){var o=this.tree.getPngUrl(),i=document.createElement("li"),s=document.createElement("img");s.width=this.width,s.src=o,s.id=t+e,s.setAttribute("data-tree-type",this.tree.treeType),s.className=v+" "+g,this.snapshots.push(s),i.appendChild(s),this.snapshotList.appendChild(i),f(s,"click",this.goBackTo.bind(this))}}}},{key:"clear",value:function(){for(var e=this.snapshotList.getElementsByTagName("li"),t=e.length;t--;)this.snapshotList.removeChild(e[0]);this.snapshots.length=0}},{key:"goBackTo",value:function(e){var t=e.target,n=t.id.replace("phylocanvas-history-","");this.tree.setTreeType(t.getAttribute("data-tree-type"),!0),this.tree.redrawFromBranch(this.tree.originalTree.branches[n])}}]),e}()},function(t,n){t.exports=e},function(e,t,n){var r=n(3);"string"==typeof r&&(r=[[e.id,r,""]]);n(6)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(4)(),t.push([e.id,".phylocanvas-history{position:absolute;top:0;bottom:0;left:0;z-index:1;box-sizing:border-box;width:240px;background:#fff;transform:translateX(-240px);transform-style:preserve-3d;will-change:transform;transition-duration:.2s;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-property:transform;border:1px solid #e7e7e7;border-left:none}.phylocanvas-history--open{transform:translateX(0);box-shadow:0 2px 2px 0 rgba(0,0,0,.14),0 3px 1px -2px rgba(0,0,0,.2),0 1px 5px 0 rgba(0,0,0,.12)}.phylocanvas-history .phylocanvas-history-title{box-sizing:border-box;text-align:center;font-family:Helvetica,Arial,sans-serif;font-size:14px;color:#666;padding:2px;border-bottom:1px solid #e7e7e7;padding:8px}.phylocanvas-history-button{border:none;font-size:24px;height:48px;margin:auto;min-width:24px;width:26px;padding:0;overflow:hidden;background:#3c7383;color:#fff;box-shadow:0 1px 1.5px 0 rgba(0,0,0,.12),0 1px 1px 0 rgba(0,0,0,.24);position:relative;line-height:normal;position:absolute;bottom:16px;right:-27px;z-index:1;outline:none;cursor:pointer;border-radius:0 2px 2px 0;background-image:url("+n(5)+");background-repeat:no-repeat;background-position:0}.phylocanvas-history-snapshots{position:absolute;top:33px;bottom:0;margin:0;padding:0;overflow-x:hidden;overflow-y:scroll}.phylocanvas-history-snapshots li{list-style:outside none none}.phylocanvas-history-snapshot{border:none;border-top-width:1px;cursor:pointer;width:100%;box-sizing:border-box;transition:background-color .2s cubic-bezier(.4,0,.2,1);display:block}.phylocanvas-history-snapshot--selected{background-color:#9bb7bf}",""])},function(e,t){"use strict";e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var s=t[o];"number"==typeof s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),e.push(s))}},e}},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyBmaWxsPSIjRkZGRkZGIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMCAwaDI0djI0SDB6IiBmaWxsPSJub25lIi8+CiAgPHBhdGggZD0iTTEzIDNjLTQuOTcgMC05IDQuMDMtOSA5SDFsMy44OSAzLjg5LjA3LjE0TDkgMTJINmMwLTMuODcgMy4xMy03IDctN3M3IDMuMTMgNyA3LTMuMTMgNy03IDdjLTEuOTMgMC0zLjY4LS43OS00Ljk0LTIuMDZsLTEuNDIgMS40MkM4LjI3IDE5Ljk5IDEwLjUxIDIxIDEzIDIxYzQuOTcgMCA5LTQuMDMgOS05cy00LjAzLTktOS05em0tMSA1djVsNC4yOCAyLjU0LjcyLTEuMjEtMy41LTIuMDhWOEgxMnoiLz4KPC9zdmc+Cg=="},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=h[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(c(r.parts[i],t))}else{for(var s=[],i=0;i<r.parts.length;i++)s.push(c(r.parts[i],t));h[r.id]={id:r.id,refs:1,parts:s}}}}function o(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],s=o[1],a=o[2],l=o[3],c={css:s,media:a,sourceMap:l};n[i]?n[i].parts.push(c):t.push(n[i]={id:i,parts:[c]})}return t}function i(e,t){var n=v(),r=m[m.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),m.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function s(e){e.parentNode.removeChild(e);var t=m.indexOf(e);t>=0&&m.splice(t,1)}function a(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function l(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function c(e,t){var n,r,o;if(t.singleton){var i=b++;n=g||(g=a(t)),r=u.bind(null,n,i,!1),o=u.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=l(t),r=d.bind(null,n),o=function(){s(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(t),r=p.bind(null,n),o=function(){s(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function u(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=x(t,o);else{var i=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}function p(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function d(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var h={},f=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},y=f(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=f(function(){return document.head||document.getElementsByTagName("head")[0]}),g=null,b=0,m=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=y()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=o(e);return r(n,t),function(e){for(var i=[],s=0;s<n.length;s++){var a=n[s],l=h[a.id];l.refs--,i.push(l)}if(e){var c=o(e);r(c,t)}for(var s=0;s<i.length;s++){var l=i[s];if(0===l.refs){for(var u=0;u<l.parts.length;u++)l.parts[u]();delete h[l.id]}}}};var x=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()}])});