!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("PhyloCanvas"));else if("function"==typeof define&&define.amd)define(["PhyloCanvas"],t);else{var r=t("object"==typeof exports?require("PhyloCanvas"):e.PhyloCanvas);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){e(this,"createTree",function(e,t){var r=e.apply(void 0,n(t)),o=s(t,2),i=o[1],a=void 0===i?{}:i;if(a.history||"undefined"==typeof a.history){var c=a.history&&"undefined"!=typeof a.history.collapsed;r.historySnapshots=[],r.history=new y(r,c?a.history.collapsed:!0)}return r}),e(c.Tree,"resizeToContainer",function(e){return this.history?void this.history.resizeTree():e.apply(this)}),this.History=y}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(c){o=!0,i=c}finally{try{!n&&a["return"]&&a["return"]()}finally{if(o)throw i}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t["default"]=i;var c=r(1),l=r(2),d=l.dom.addClass,h=l.dom.hasClass,u=l.dom.removeClass,p=l.events.fireEvent,f=l.events.addEvent,v=l.events.killEvent,y=function(){function e(t,r){o(this,e),this.tree=t,this.injectCss(),this.div=this.createDiv(t.canvasEl),this.tree.addListener("subtree",function(e){this.addSnapshot(e.node)}.bind(this)),this.tree.addListener("loaded",this.reset.bind(this)),this.tree.addListener("typechanged",function(){this.addSnapshot(this.tree.root.id)}.bind(this)),r?this.collapse():this.expand()}return a(e,[{key:"reset",value:function(){this.clear(),this.tree.drawn&&this.addSnapshot(this.tree.root.id)}},{key:"collapse",value:function(){d(this.div,"collapsed"),this.toggleDiv.firstChild.data=">",this.resizeTree(),this.tree.draw()}},{key:"expand",value:function(){u(this.div,"collapsed"),this.toggleDiv.firstChild.data="<",this.resizeTree(),this.tree.draw()}},{key:"isCollapsed",value:function(){return h(this.div,"collapsed")}},{key:"toggle",value:function(){this.isCollapsed()?this.expand():this.collapse(),p(this.tree.canvasEl,"historytoggle",{isOpen:!this.isCollapsed()})}},{key:"createDiv",value:function(e){var t=document.createElement("div");t.className="pc-history",f(t,"click",v),f(t,"contextmenu",v);var r=document.createElement("div");r.innerHTML="History",r.className="pc-history-title",t.appendChild(r);var n=document.createElement("div");n.appendChild(document.createTextNode("<")),n.className="toggle",f(n,"click",this.toggle.bind(this)),t.appendChild(n),this.toggleDiv=n;var o=document.createElement("ul");return o.className="pc-history-snapshots",t.appendChild(o),this.snapshotList=o,e.appendChild(t),t}},{key:"resizeTree",value:function(){var e=this.tree;this.width=this.div.offsetWidth,e.setSize(e.canvasEl.offsetWidth-this.width,e.canvasEl.offsetHeight),this.isCollapsed()?e.canvasEl.getElementsByTagName("canvas")[0].style.marginLeft=this.width+"px":e.canvasEl.getElementsByTagName("canvas")[0].style.marginLeft="20%"}},{key:"addSnapshot",value:function(e){var t="phylocanvas-history-",r=this.tree.treeType,n=!1;if(this.tree.historySnapshots.forEach(function(o){o.style.background="transparent",o.id===t+e&&o.getAttribute("data-tree-type")===r&&(n=!0,o.style.background="lightblue")}),!n){var o=this.tree.getPngUrl(),i=document.createElement("li"),s=document.createElement("img");s.width=this.width,s.src=o,s.id=t+e,s.setAttribute("data-tree-type",this.tree.treeType),s.style.background="lightblue",this.tree.historySnapshots.push(s),i.appendChild(s),this.snapshotList.appendChild(i),f(s,"click",this.goBackTo.bind(this))}}},{key:"clear",value:function(){for(var e=this.snapshotList.getElementsByTagName("li"),t=e.length;t--;)this.snapshotList.removeChild(e[0])}},{key:"goBackTo",value:function(e){var t=e.target;this.tree.setTreeType(t.getAttribute("data-tree-type"),!0),this.tree.redrawFromBranch(this.tree.originalTree.branches[t.id.replace("phylocanvas-history-","")])}},{key:"injectCss",value:function(){var e=".pc-history { position: absolute; top: 0; bottom: 0; left: 0; box-sizing: border-box; width: 20%; overflow: hidden; background: #EEE }.pc-history .pc-history-title { box-sizing: border-box; height: 20px; text-align: center; font-size: 13px; color: #666; padding: 2px; border-bottom: 1px solid #bbb }.pc-history .toggle { position: absolute; top: 0; right: 0; padding: 2px 8px; cursor: pointer; border-top-left-radius: 50%; border-bottom-left-radius: 50%; background-color: #666; color: #FFF; box-sizing: border-box; height: 20px; }.pc-history.collapsed .toggle { border-radius: 0 50% 50% 0 }.pc-history .toggle:hover { background-color: #FFF; color: #CCC }.pc-history.collapsed { width: 25px }.pc-history.collapsed .pc-history-snapshots { display: none }.pc-history.collapsed .pc-history-title { writing-mode: tb-rl; -webkit-transform: rotate(270deg); -moz-transform: rotate(270deg); -o-transform: rotate(270deg); -ms-transform: rotate(270deg); transform: rotate(270deg); margin-top: 70px; background: 0 0; color: #666; letter-spacing: 1.2px; border-bottom: none }.pc-history-snapshots { position: absolute; top: 20px; bottom: 0; margin: 0; padding: 0; overflow-x: hidden; overflow-y: scroll; }.pc-history-snapshots li { list-style: outside none none }.pc-history img { border: 0px solid #CCC; border-top-width: 1px; cursor: pointer; width: 100%; box-sizing: border-box; transition: background-color .25s ease; display: block }.pc-history img:hover { background-color: #fff }",t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e)),t.appendChild(r)}}]),e}();e.exports=t["default"]},function(t,r){t.exports=e},function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var o=r(3),i=n(o),s=r(6),a=n(s),c=r(4),l=n(c),d=r(5),h=n(d);t["default"]={canvas:i,constants:a,dom:l,events:h},e.exports=t["default"]},function(e,t,r){"use strict";function n(e){return e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||1}function o(e){return(window.devicePixelRatio||1)/n(e)}function i(e){return e=e-c.getX(this.canvas.canvas)+window.pageXOffset,e*=o(this.canvas),e-=this.canvas.canvas.width/2,e-=this.offsetx,e/=this.zoom}function s(e){return e=e-c.getY(this.canvas.canvas)+window.pageYOffset,e*=o(this.canvas),e-=this.canvas.canvas.height/2,e-=this.offsety,e/=this.zoom}function a(e,t,r){return[i.call(r,e),s.call(r,t)]}Object.defineProperty(t,"__esModule",{value:!0}),t.getBackingStorePixelRatio=n,t.getPixelRatio=o,t.translateClick=a;var c=r(4)},function(e,t,r){"use strict";function n(e){var t=new Blob([e],{type:"text/csv;charset=utf-8"});return h.createObjectURL(t)}function o(e,t){var r=document.createElement("a"),n="undefined"!=typeof r.download;r.href=e,r.target="_blank",n&&(r.download=t),d.fireEvent(r,"click"),n&&h.revokeObjectURL(r.href)}function i(e){for(var t=0;e;)t+=e.offsetLeft,e=e.offsetParent;return t}function s(e){for(var t=0;e;)t+=e.offsetTop,e=e.offsetParent;return t}function a(e,t){var r=e.className.split(" ");-1===r.indexOf(t)&&(r.push(t),e.className=r.join(" "))}function c(e,t){var r=e.className.split(" "),n=r.indexOf(t);-1!==n&&(r.splice(n,1),e.className=r.join(" "))}function l(e,t){var r=e.className.split(" "),n=r.indexOf(t);return-1!==n}Object.defineProperty(t,"__esModule",{value:!0}),t.createBlobUrl=n,t.setupDownloadLink=o,t.getX=i,t.getY=s,t.addClass=a,t.removeClass=c,t.hasClass=l;var d=r(5),h=window.URL||window.webkitURL},function(e,t){"use strict";function r(e){return e.preventDefault(),!1}function n(e,t){var r,n,o=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];document.createEvent?(r=document.createEvent("HTMLEvents"),r.initEvent(t,!0,!0)):(r=document.createEventObject(),r.eventType=t),r.eventName=t;for(n in o)o.hasOwnProperty(n)&&(r[n]=o[n]);document.createEvent?e.dispatchEvent(r):e.fireEvent("on"+r.eventType,r)}function o(e,t,r){e.addEventListener?e.addEventListener(t,r,!1):e.attachEvent("on"+t,function(){return r.call(e,window.event)})}function i(e){e.stopPropagation(),e.preventDefault()}function s(e,t){var r;return r="string"==typeof t?function(r){return e[t]?e[t](r):void 0}:function(){return t(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.preventDefault=r,t.fireEvent=n,t.addEvent=o,t.killEvent=i,t.createHandler=s},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={FORTYFIVE:Math.PI/4,QUARTER:Math.PI/2,HALF:Math.PI,FULL:2*Math.PI};t.Angles=r;var n={x:"star",s:"square",o:"circle",t:"triangle"};t.Shapes=n}])});