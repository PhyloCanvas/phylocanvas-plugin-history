!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("phylocanvas"));else if("function"==typeof define&&define.amd)define(["phylocanvas"],t);else{var r=t("object"==typeof exports?require("phylocanvas"):e.phylocanvas);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(e){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=r(1),a=n(i);t["default"]=a["default"]},function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){e(this,"createTree",function(e,t){var r=e.apply(void 0,n(t)),i=o(t,2),a=i[1],s=void 0===a?{}:a;return r.history=new b(r,s.history||{}),r}),this.History=b}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var r=[],n=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(c){i=!0,a=c}finally{try{!n&&s["return"]&&s["return"]()}finally{if(i)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();t["default"]=a;var c=r(2),l=c.utils.dom,u=l.addClass,h=l.removeClass,d=c.utils.events,p=d.fireEvent,f=d.addEvent,y=d.killEvent,v="phylocanvas-history-snapshot",m=v+"--selected",b=function(){function e(t,r){var n=this,a=r.parentElement,o=void 0===a?t.containerElement:a;i(this,e),this.tree=t,this.snapshots=[],this.isOpen=!1,this.container=this.createElements(o),this.tree.addListener("subtree",function(e){var t=e.node;return n.addSnapshot(t)}),this.tree.addListener("loaded",function(){return n.addSnapshot(n.tree.root.id)}),this.tree.addListener("typechanged",function(){return n.addSnapshot(n.tree.root.id)})}return s(e,[{key:"toggle",value:function(){this.isOpen=!this.isOpen,(this.isOpen?u:h)(this.container,"phylocanvas-history--open"),p(this.tree.containerElement,"historytoggle",{isOpen:this.isOpen})}},{key:"createElements",value:function(e){var t=document.createElement("div");t.className="phylocanvas-history",f(t,"click",y),f(t,"contextmenu",y);var r=document.createElement("div");r.innerHTML="History",r.className="phylocanvas-history-title",t.appendChild(r);var n=document.createElement("button");n.className="phylocanvas-history-button",n.title="History",f(n,"click",this.toggle.bind(this)),t.appendChild(n),this.button=n;var i=document.createElement("ul");return i.className="phylocanvas-history-snapshots",t.appendChild(i),this.snapshotList=i,e.appendChild(t),t}},{key:"addSnapshot",value:function(e){if(e){var t=this.tree.treeType,r=!1;if(this.snapshots.forEach(function(n){h(n,m),n.getAttribute("data-tree-root")===e&&n.getAttribute("data-tree-type")===t&&(r=!0,u(n,m))}),!r){var n=this.tree.getPngUrl(),i=document.createElement("li");i.className=v+" "+m,i.setAttribute("data-tree-root",e),i.setAttribute("data-tree-type",this.tree.treeType),i.className=v+" "+m;var a=document.createElement("img");a.src=n,this.snapshots.push(i),i.appendChild(a),this.snapshotList.appendChild(i),f(i,"click",this.goBackTo.bind(this,i))}}}},{key:"clear",value:function(){for(var e=this.snapshots.length;e--;)this.snapshotList.removeChild(this.snapshots[0]);this.snapshots.length=0}},{key:"goBackTo",value:function(e){var t=e.getAttribute("data-tree-root");this.tree.setTreeType(e.getAttribute("data-tree-type"),!0),this.tree.redrawFromBranch(this.tree.originalTree.branches[t])}}]),e}()},function(t,r){t.exports=e}])});